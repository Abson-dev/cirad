library(SDMSelect)
filename<-paste0("C:\\Users\\Hp\\OneDrive\\cirad\\Data\\BD_Arbre","\\arbres_diohine_mai2018_par_Zone_OK_BON.shp")
filename
library(sp)
#wr<-poly2nb(Species_shape,row.names = Species_shape$ID_GPS,queen = F)
library(sf)
Species_shape<-shapefile(filename)
library(raster)
Species_shape<-shapefile(filename)
library(rgdal)
library(dismo)
library(rJava)
#############################################
# crop ou mask
#shp des variables sur les espèces Species_shape
#.tif des variables bioclimatiques, worlClim
ext<-extent(Species_shape)
library(raster)
filename<-paste0("D:\\Stage_SDM\\SDM\\Data\\BD_Arbre","\\arbres_diohine_mai2018_par_Zone_OK_BON.shp")
filename
Species_shape<-shapefile(filename)
#wr<-poly2nb(Species_shape,row.names = Species_shape$ID_GPS,queen = F)
library(sf)
l1<-list.files("D:\\Stage_SDM\\SDM\\Data\\WorldClim\\wc2.0_30s_bio\\",patt="\\.tif")
l1<-sprintf("D:\\Stage_SDM\\SDM\\Data\\WorldClim\\bio\\%s",l1)
l1
worlClim<-stack(l1)
library(tidyverse)
filename<-paste0("D:\\Stage_SDM\\SDM\\Data\\BD_Arbre","\\arbres_diohine_mai2018_par_Zone_OK_BON.shp")
filename
Species_shape<-shapefile(filename)
library(sf)
Species<-st_read(filename,quiet = T)
library(SDMSelect)
library(dplyr)
Base_Espece<-Species
Base_Espece$Faidherbia_albida<-if_else(Base_Espece$Species =="Faidherbia albida",1,0)
#Balanites aegyptiaca
Base_Espece$Balanites_aegyptiaca<-if_else(Base_Espece$Species =="Balanites aegyptiaca",1,0)
#Anogeissus leiocarpus
Base_Espece$Anogeissus_leiocarpus<-if_else(Base_Espece$Species =="Anogeissus leiocarpus",1,0)
#Adansonia digitata
Base_Espece$Adansonia_digitata<-if_else(Base_Espece$Species =="Adansonia digitata",1,0)
#Acacia nilotica
Base_Espece$Acacia_nilotica<-if_else(Base_Espece$Species =="Acacia nilotica",1,0)
##############
l1<-list.files("D:\\Stage_SDM\\SDM\\Data\\WorldClim\\wc2.0_30s_bio\\",patt="\\.tif")
l1<-sprintf("D:\\Stage_SDM\\SDM\\Data\\WorldClim\\wc2.0_30s_bio\\%s",l1)
l1
worlClim<-stack(l1)
ext<-extent(Species)
worldClim.crop<-crop(worlClim,ext)
#data<-CovarExtract(x=Base_Espece,cov.paths = l1)
library(sf)
data_df<-st_drop_geometry(Base_Espece)
class(data_df)
#############zones
# data_Faidherbia_1<-data_Faidherbia %>%
#   filter(Zone==1)
# Faidherbia_1<-data_Faidherbia_1 %>%
#   select(xcoord,ycoord)
# plot(worldClim.crop,1)
# plot(zone_etude, add=TRUE)
# points(Faidherbia_1,col='blue')
#######################################
##########???les espèces dans les différentes zones
Base_Espece_Zone1<-data_df %>%
filter(Zone == 1)
Base_Espece_Zone2<-data_df %>%
filter(Zone == 2)
Base_Espece_Zone4<-data_df %>%
filter(Zone == 3)
Base_Espece_Zone4<-data_df %>%
filter(Zone == 4)
###################Modélisation dans la zone 1, avec les variables de worldClim
########Faidherbia albida
Base_Faidherbia_Z1<-Base_Espece_Zone1 %>%
select(xcoord,ycoord,Faidherbia_albida)
names(Base_Faidherbia_Z1)<-c("lon","lat","Faidherbia")
#Transform data as SpatialPointDataFrame
sp::coordinates(Base_Faidherbia_Z1) <-~lon+lat
sp::proj4string(Base_Faidherbia_Z1) <-"+proj=longlat +datum=WGS84"
library(ggplot2)
##############################end SDMSelect
zone_etude1<-st_read("C:\\Users\\Hp\\OneDrive\\cirad\\Data\\BD_Arbre\\Zone_1.shp",quiet = T)
##############################end SDMSelect
########Faidherbia albida
Base_Faidherbia_Z1<-Base_Espece_Zone1 %>%
select(xcoord,ycoord,Faidherbia_albida)
names(Base_Faidherbia_Z1)<-c("lon","lat","Faidherbia")
zone_etude1<-st_read("C:\\Users\\Hp\\OneDrive\\cirad\\Data\\BD_Arbre\\Zone_1.shp",quiet = T)
zone_etude1<-shapefile("C:\\Users\\Hp\\OneDrive\\cirad\\Data\\BD_Arbre\\Zone_1.shp",quiet = T)
zone_etude1<-shapefile("C:\\Users\\Hp\\OneDrive\\cirad\\Data\\BD_Arbre\\Zone_1.shp")
#Enregistrements en double pour l'espèce
# which records are duplicates (only for the first 10 columns)?
dups <- duplicated(Base_Faidherbia_Z1[, 1:3])
class(dups)
table(dups)
#♥pas de doublon
#Vérification croisée
#Transform data as SpatialPointDataFrame
sp::coordinates(Base_Faidherbia_Z1) <-~lon+lat
sp::proj4string(Base_Faidherbia_Z1) <-"+proj=longlat +datum=WGS84"
sp::proj4string(zone_etude1) <-"+proj=longlat +datum=WGS84"
#sp::proj4string(zone_etude1) <-"+proj=longlat +datum=WGS84"
crs(zone_etude1) <- crs(Base_Faidherbia_Z1)
zone_etude1
zone_etude1<-shapefile("C:\\Users\\Hp\\OneDrive\\cirad\\Data\\BD_Arbre\\Zone_1_BON.shp")
plot(zone_etude1)
extent(zone_etude1)
zone_etude1<-crop(zone_etude1,ext)
zone_etude1
#Enregistrements en double pour l'espèce
# which records are duplicates (only for the first 10 columns)?
dups <- duplicated(Base_Faidherbia_Z1[, 1:3])
zone_etude1
plot(zone_etude1)
extent(zone_etude1)
zone_etude1<-shapefile("C:\\Users\\Hp\\OneDrive\\cirad\\Data\\BD_Arbre\\Zone_1_BON.shp")
extent(zone_etude1)
plot(zone_etude1)
plot(worldClim.crop$bio1,add=T)
plot(worldClim.crop$bio1)
plot(zone_etude1,add=T)
crs(zone_etude1)
crs(worldClim.crop)
extent(worldClim.crop)<-extent(zone_etude1)
worldClim.crop
plot(worldClim.crop$bio1)
plot(zone_etude1,add=T)
plot(zone_etude1, add=T, border='blue', lwd=2)
points(Base_Faidherbia_Z1$Faidherbia, col='red', pch=20, cex=2)
worldClim.crop<-crop(worlClim,ext)
worldClim.crop1<-worldClim.crop
extent(zone_etude1)<-extent(worldClim.crop1)
zone_etude1<-shapefile("C:\\Users\\Hp\\OneDrive\\cirad\\Data\\BD_Arbre\\Zone_1_BON.shp")
extent(zone_etude1)<-extent(worldClim.crop1)
extent(worldClim.crop1)
extent(zone_etude1)
plot(worldClim.crop$bio1)
extent(worldClim.crop1)<-extent(zone_etude1)
plot(worldClim.crop1$bio1)
plot(worldClim.crop$bio1)
plot(worldClim.crop1$bio1)
plot(worldClim.crop1$bio1,title("ok"))
plot(worldClim.crop1$bio1,title("ok"))
plot(worldClim.crop1$bio1,title("ok"))
plot(zone_etude1, add=T, border='blue', lwd=2)
Base_Faidherbia_Z1
Base_Faidherbia_Z<-Base_Faidherbia_Z1
#extract covariables, combine with dataset
data<-CovarExtract(x=Base_Faidherbia_Z1,cov.paths = l1)
sp::plot(data,col=c("red","blue")[data@data$Faidherbia + 1],pch=20, cex=c(0.5,1)[data@data$Faidherbia + 1],add=T)
data
extent(Base_Faidherbia_Z)<-extent(zone_etude1)
Species
plot(zone_etude1)
plot(worldClim.crop$bio1)
extent(zone_etude1)
class(zone_etude1)
class(worlClim)
class(worlClim.crop)
class(worldClim.crop)
plot(worldClim.crop$bio1)
plot(worldClim.crop$bio1)
plot(worldClim.crop1$bio1)
plot(zone_etude1, add=T, border='blue', lwd=2)
##############################end SDMSelect
########Faidherbia albida
Base_Faidherbia_Z1<-Base_Espece_Zone1 %>%
select(xcoord,ycoord,Faidherbia_albida)
names(Base_Faidherbia_Z1)<-c("lon","lat","Faidherbia")
# note the "add=TRUE" argument with plot
plot(Base_Faidherbia_Z1, add=TRUE)
plot(worldClim.crop1$bio1)
plot(zone_etude1, add=T, border='blue', lwd=2)
Base_Faidherbia_Z<-Base_Faidherbia_Z1
Base_Faidherbia_Z1
View(Base_Faidherbia_Z)
plo_Faidherbia<-Base_Faidherbia_Z1 %>%
select(lon,lat)
# with the points function, "add" is implicit
points(plo_Faidherbia, col='blue')
# with the points function, "add" is implicit
points(plo_Faidherbia, col='blue')
# with the points function, "add" is implicit
points(plo_Faidherbia)
# with the points function, "add" is implicit
points(plo_Faidherbia)
plot(worldClim.crop$bio1)
# with the points function, "add" is implicit
points(plo_Faidherbia)
plot(zone_etude1, add=T, border='blue', lwd=2)
plot(worldClim.crop1$bio1)
plot(zone_etude1, add=T, border='blue', lwd=2)
plot(worldClim.crop$bio1)
# with the points function, "add" is implicit
points(plo_Faidherbia)
Base_Espece<-Species
Base_Espece$Faidherbia_albida<-if_else(Base_Espece$Species =="Faidherbia albida",1,0)
#Balanites aegyptiaca
Base_Espece$Balanites_aegyptiaca<-if_else(Base_Espece$Species =="Balanites aegyptiaca",1,0)
#Anogeissus leiocarpus
Base_Espece$Anogeissus_leiocarpus<-if_else(Base_Espece$Species =="Anogeissus leiocarpus",1,0)
#Adansonia digitata
Base_Espece$Adansonia_digitata<-if_else(Base_Espece$Species =="Adansonia digitata",1,0)
#Acacia nilotica
Base_Espece$Acacia_nilotica<-if_else(Base_Espece$Species =="Acacia nilotica",1,0)
extent(Species)
plot(zone_etude1)
#extract covariables, combine with dataset
data<-CovarExtract(x=Base_Faidherbia_Z1,cov.paths = l1)
Base_Espece<-Species
Base_Espece$Faidherbia_albida<-if_else(Base_Espece$Species =="Faidherbia albida",1,0)
#Balanites aegyptiaca
Base_Espece$Balanites_aegyptiaca<-if_else(Base_Espece$Species =="Balanites aegyptiaca",1,0)
#Anogeissus leiocarpus
Base_Espece$Anogeissus_leiocarpus<-if_else(Base_Espece$Species =="Anogeissus leiocarpus",1,0)
#Adansonia digitata
Base_Espece$Adansonia_digitata<-if_else(Base_Espece$Species =="Adansonia digitata",1,0)
#Acacia nilotica
Base_Espece$Acacia_nilotica<-if_else(Base_Espece$Species =="Acacia nilotica",1,0)
ext<-extent(Species)
worldClim.crop<-crop(worlClim,ext)
#data<-CovarExtract(x=Base_Espece,cov.paths = l1)
library(sf)
data_df<-st_drop_geometry(Base_Espece)
class(data_df)
##########???les espèces dans les différentes zones
Base_Espece_Zone1<-data_df %>%
filter(Zone == 1)
Base_Espece_Zone2<-data_df %>%
filter(Zone == 2)
Base_Espece_Zone4<-data_df %>%
filter(Zone == 3)
Base_Espece_Zone4<-data_df %>%
filter(Zone == 4)
###################Modélisation dans la zone 1, avec les variables de worldClim
#extract covariables, combine with dataset
data<-CovarExtract(x=Base_Faidherbia_Z1,cov.paths = l1)
###################Modélisation dans la zone 1, avec les variables de worldClim
#extract covariables, combine with dataset
#Transform data as SpatialPointDataFrame
FZ1<-Base_Faidherbia_Z1
sp::coordinates(FZ1) <-~lon+lat
sp::proj4string(FZ1) <-"+proj=longlat +datum=WGS84"
data<-CovarExtract(x=FZ1,cov.paths = l1)
names(data)
#show observations positions Species<-st_read(filename,quiet = T)
par(mar=c(2,2,2,2))
raster::plot(worldClim.crop,"bio1")
sp::plot(zone_etude1, add=T)
sp::plot(data,col=c("red","blue")[data@data$Faidherbia + 1],pch=20, cex=c(0.5,1)[data@data$Faidherbia + 1],add=T)
data
###################Modélisation dans la zone 1, avec les variables de worldClim
#extract covariables, combine with dataset
#Transform data as SpatialPointDataFrame
class(Base_Faidherbia_Z1)
FZ1<-Base_Faidherbia_Z1
view(FZ1)
sp::coordinates(FZ1) <-~lon+lat
sp::proj4string(FZ1) <-"+proj=longlat +datum=WGS84"
data<-CovarExtract(x=FZ1,cov.paths = l1) # en utilsisant SDMSelect
names(data)
dataFZ1<-CovarExtract(x=FZ1,cov.paths = l1) # en utilsisant SDMSelect
names(dataFZ1)
class(dataFZ1)
dataFZ1
worldClim.cropFZ1<-worldClim.crop
class(dataFZ1)
library(maptools)
writeSpatialShape(dataFZ1, "dataFZ1")
writeOGR(dataFZ1, "dataFZ1")
library(sf)
writeOGR(dataFZ1, "dataFZ1")
library(rgdal)
writeOGR(obj=dataFZ1,layer="dataFZ1",driver="ESRI Shapefile")
tmpdir<-"C:\\Users\\Hp\\OneDrive\\redactions"
writeOGR(obj=dataFZ1,dsn=tmpdir,layer="dataFZ1",driver="ESRI Shapefile")
Base_Espece$Faidherbia_albida<-if_else(Base_Espece$Species =="Faidherbia albida","1","0")
data_df<-st_drop_geometry(Base_Espece)
class(data_df)
##########???les espèces dans les différentes zones
Base_Espece_Zone1<-data_df %>%
filter(Zone == 1)
Base_Espece_Zone2<-data_df %>%
filter(Zone == 2)
Base_Espece_Zone4<-data_df %>%
filter(Zone == 3)
Base_Espece_Zone4<-data_df %>%
filter(Zone == 4)
###################Modélisation dans la zone 1, avec les variables de worldClim
#extract covariables, combine with dataset
#Transform data as SpatialPointDataFrame
class(Base_Faidherbia_Z1)
FZ1<-Base_Faidherbia_Z1
view(FZ1)
sp::coordinates(FZ1) <-~lon+lat
sp::proj4string(FZ1) <-"+proj=longlat +datum=WGS84"
dataFZ1<-CovarExtract(x=FZ1,cov.paths = l1) # en utilsisant SDMSelect
dataFZ1<-CovarExtract(x=FZ1,cov.paths = l1,is.factor = as.factor(FZ1$Faidherbia)) # en utilsisant SDMSelect
writeOGR(obj=dataFZ1,dsn=tmpdir,layer="dataFZ1",driver="ESRI Shapefile")
writeOGR(obj=dataFZ1,dsn=tmpdir,layer="dataFZ1",driver="ESRI Shapefile")
writeOGR(obj=worldClim.crop,dsn=tmpdir,layer="worldClim.crop",driver="ESRI Shapefile")
raster::plot(worldClim.crop,"bio1")
sp::plot(data,col=c("red","blue")[data@data$Faidherbia + 1],pch=20, cex=c(0.5,1)[data@data$Faidherbia + 1],add=T)
png("bio1F1.png")
